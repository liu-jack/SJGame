var Route=function(){var t=!1,e=[],n=[],i=function(){_bindRoutes=function(){if(this.routes){var t=[];for(var e in this.routes)t.unshift([e,this.routes[e]]);for(var n=t.length-1,i=0;n>=i;n--)this.route(t[n][0],t[n][1],this[t[n][1]],this)}},_bindRoutes.call(this),this.initialize()};i.routeInit=function(t){try{new window[t+"Route"]}catch(e){return}i.start()},i.start=function(){function e(){var t=window.location.hash;this.trigger(t.replace(r.routeStripper,"")),i.triggerHashEvent()}if(!t){var n=this;return"onhashchange"in window?window.onhashchange=function(){e.call(n.prototype)}:setInterval(function(){var t=window.location.hash;t!=n.fragment&&(n.fragment=t,e.call(n.prototype))},50),this.fragment=window.location.hash,e.call(this.prototype),t=!0}return!1},i.triggerHashEvent=function(){for(var t,e=window.location.hash,r=i.hashSplit(e),o=0,s=n.length-1;s>=o;s--)t=n[s].callback,t&&"function"==typeof t&&t.apply(this,[e,r])},i.prototype.trigger=function(t){var n;return r.any(e,function(e){if(e.route.test(t)){var i=e.routeModel.beforeRoute,r=e.routeModel.afterRoute;return i&&i.call(e.routeModel),e.callback(t),r&&r.call(e.routeModel),n={name:e.name},!0}}),n},i.hashSplit=function(t){return t.replace(r.paramStripper,"").split("/")},i.register=function(e,r){n.push({callback:r,name:e}),t&&i.triggerHashEvent()},i.extend=function(t){var e=function(){for(var e in t)this[e]=t[e];i.call(this)};return e.prototype=i.prototype,e},i.prototype.route=function(t,e,n,i){t instanceof RegExp||(t=r._routeToRegExp(t)),n||(n=this[e]),this.listen(t,e,r.bind(function(e){var i=r._extractParameters(t,e);return n?n.apply(this,i):void 0},this),i)},i.prototype.listen=function(t,n,i,r){e.push({route:t,name:n,callback:i,routeModel:r})};var r={namedParam:/:\w+/g,splatParam:/\*\w+/g,escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,routeStripper:/^[#\/]/,paramStripper:/^#!/,_routeToRegExp:function(t){return t=""!=t?t.replace(this.escapeRegExp,"\\$&").replace(this.namedParam,"([^/]+)").replace(this.splatParam,"(.*?)"):t,new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)},isRegExp:function(t){return t instanceof RegExp},bind:function(t,e){return t.bind?Function.bind.apply(t,Array.prototype.slice.call(arguments,1)):function(n){t.call(e,n)}},any:function(t,e,n){var i=!1;if(null==t)return i;if(t.some)return t.some(e,n);for(var r=0,o=t.length-1;o>=r&&!i&&!(i=e.call(n,t[o],o));o--);return!!i}};return i}();